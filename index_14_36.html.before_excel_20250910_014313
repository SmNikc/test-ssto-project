<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–æ–¥—É–ª—å –¢–ï–°–¢ –°–°–¢–û - –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º</title>
    
    <!-- OpenLayers –¥–ª—è –∫–∞—Ä—Ç—ã -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@v7.3.0/ol.css">
    <script src="https://cdn.jsdelivr.net/npm/ol@v7.3.0/dist/ol.js"></script>
    
    <!-- XLSX –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Excel -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    
    <!-- jsPDF –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–∏—Ä–∏–ª–ª–∏—Ü—ã –¥–ª—è PDF -->
    <script>
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ç—Ä–∞–Ω—Å–ª–∏—Ç–µ—Ä–∞—Ü–∏–∏ –∫–∏—Ä–∏–ª–ª–∏—Ü—ã –≤ –ª–∞—Ç–∏–Ω–∏—Ü—É
        function cyrillicToTranslit(text) {
            const converter = {
                '–∞': 'a', '–±': 'b', '–≤': 'v', '–≥': 'g', '–¥': 'd',
                '–µ': 'e', '—ë': 'e', '–∂': 'zh', '–∑': 'z', '–∏': 'i',
                '–π': 'y', '–∫': 'k', '–ª': 'l', '–º': 'm', '–Ω': 'n',
                '–æ': 'o', '–ø': 'p', '—Ä': 'r', '—Å': 's', '—Ç': 't',
                '—É': 'u', '—Ñ': 'f', '—Ö': 'h', '—Ü': 'ts', '—á': 'ch',
                '—à': 'sh', '—â': 'sch', '—ä': '', '—ã': 'y', '—å': '',
                '—ç': 'e', '—é': 'yu', '—è': 'ya',
                '–ê': 'A', '–ë': 'B', '–í': 'V', '–ì': 'G', '–î': 'D',
                '–ï': 'E', '–Å': 'E', '–ñ': 'Zh', '–ó': 'Z', '–ò': 'I',
                '–ô': 'Y', '–ö': 'K', '–õ': 'L', '–ú': 'M', '–ù': 'N',
                '–û': 'O', '–ü': 'P', '–†': 'R', '–°': 'S', '–¢': 'T',
                '–£': 'U', '–§': 'F', '–•': 'H', '–¶': 'Ts', '–ß': 'Ch',
                '–®': 'Sh', '–©': 'Sch', '–™': '', '–´': 'Y', '–¨': '',
                '–≠': 'E', '–Æ': 'Yu', '–Ø': 'Ya',
                ' ': ' ', '.': '.', ',': ',', '!': '!', '?': '?',
                '-': '-', ':': ':', ';': ';', '"': '"', "'": "'",
                '(': '(', ')': ')', '[': '[', ']': ']', '/': '/',
                '¬´': '"', '¬ª': '"', '‚Äî': '-', '‚Äì': '-'
            };
            
            if (!text) return '';
            return text.split('').map(char => converter[char] || char).join('');
        }
        
        // –§—É–Ω–∫—Ü–∏—è-–æ–±–µ—Ä—Ç–∫–∞ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –≤ PDF
        function addTextToPDF(doc, text, x, y, options) {
            try {
                // –¢—Ä–∞–Ω—Å–ª–∏—Ç–µ—Ä–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç –¥–ª—è PDF
                const translitText = cyrillicToTranslit(String(text));
                doc.text(translitText, x, y, options);
            } catch (e) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Ç–µ–∫—Å—Ç–∞ –≤ PDF:', e);
                // –ü—Ä–æ–±—É–µ–º –¥–æ–±–∞–≤–∏—Ç—å –±–µ–∑ –æ–ø—Ü–∏–π
                try {
                    doc.text(String(text), x, y);
                } catch (e2) {
                    console.error('–ù–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç:', text);
                }
            }
        }
    </script>
    
    <style>
        /* ===== –ë–ê–ó–û–í–´–ï –°–¢–ò–õ–ò ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
            padding: 20px 0;
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
        }
        
        .logo-text h1 {
            font-size: 24px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 2px;
        }
        
        .logo-text p {
            font-size: 12px;
            color: #666;
        }
        
        .header-actions {
            display: flex;
            gap: 10px;
        }
        
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: 0.3s;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }
        
        .btn-secondary {
            background: #e2e8f0;
            color: #4a5568;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .navigation {
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            margin: 20px auto;
            max-width: 1400px;
            border-radius: 10px;
            padding: 10px;
        }
        
        .tabs {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }
        
        .tab {
            padding: 10px 20px;
            background: transparent;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            color: #4a5568;
            transition: 0.3s;
        }
        
        .tab:hover {
            background: #f7fafc;
        }
        
        .tab.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }
        
        .content-area {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .tab-content {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            animation: fadeIn 0.3s ease;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .stat-card h3 {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 10px;
        }
        
        .stat-card .value {
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stat-card .change {
            font-size: 14px;
            opacity: 0.9;
        }
        
        /* –§–æ—Ä–º—ã */
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #4a5568;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
            transition: 0.3s;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .form-group.highlight {
            background: #fff3cd;
            border: 3px solid #ff6b6b;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
        }
        
        .form-group.highlight label {
            color: #d32f2f;
            font-size: 18px;
            font-weight: bold;
        }
        
        .form-group.highlight input {
            font-size: 20px;
            font-weight: bold;
            border: 3px solid #ff6b6b;
        }
        
        /* –¢–∞–±–ª–∏—Ü—ã */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        th {
            background: #f7fafc;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            color: #4a5568;
            border-bottom: 2px solid #e2e8f0;
        }
        
        td {
            padding: 12px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        tr:hover {
            background: #f7fafc;
        }
        
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .status-pending {
            background: #fef3c7;
            color: #92400e;
        }
        
        .status-confirmed {
            background: #d1fae5;
            color: #065f46;
        }
        
        .status-active {
            background: #dbeafe;
            color: #1e40af;
        }
        
        /* –ö–∞—Ä—Ç–∞ */
        #map {
            height: 500px;
            border-radius: 10px;
            margin-top: 20px;
        }
        
        .map-controls {
            margin-top: 20px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            animation: fadeIn 0.3s;
        }
        
        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .modal-title {
            font-size: 24px;
            font-weight: bold;
            color: #2d3748;
        }
        
        .modal-close {
            font-size: 30px;
            color: #a0aec0;
            cursor: pointer;
            background: none;
            border: none;
        }
        
        .modal-close:hover {
            color: #4a5568;
        }
        
        /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            z-index: 3000;
            animation: slideIn 0.3s;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
        
        .notification.success {
            background: #48bb78;
        }
        
        .notification.error {
            background: #f56565;
        }
        
        .notification.info {
            background: #4299e1;
        }
        
        /* –°–∫—Ä—ã—Ç—ã–π input –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤ */
        #excel-upload {
            display: none;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">üö¢</div>
                <div class="logo-text">
                    <h1>–ú–û–î–£–õ–¨ –¢–ï–°–¢ –°–°–¢–û</h1>
                    <p>–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –°–°–¢–û</p>
                </div>
            </div>
            <div class="header-actions">
                <button class="btn btn-primary" onclick="window.excelLoader.openFileDialog()">üìä –ó–∞–≥—Ä—É–∑–∏—Ç—å Excel</button>
                <button class="btn btn-secondary" onclick="window.emailSender.configureSMTP()">‚úâÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Email</button>
                <button class="btn btn-secondary" onclick="exportSettings()">üíæ –≠–∫—Å–ø–æ—Ä—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫</button>
                <button class="btn btn-secondary" onclick="importSettings()">üì• –ò–º–ø–æ—Ä—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫</button>
            </div>
        </div>
    </div>
    
    <div class="navigation">
        <div class="tabs">
            <button class="tab active" onclick="switchTab('dashboard')">üìä –ì–ª–∞–≤–Ω–∞—è</button>
            <button class="tab" onclick="switchTab('new-request')">‚ûï –ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞</button>
            <button class="tab" onclick="switchTab('requests')">üìã –ó–∞—è–≤–∫–∏</button>
            <button class="tab" onclick="switchTab('signals')">üì° –°–∏–≥–Ω–∞–ª—ã</button>
            <button class="tab" onclick="switchTab('terminals')">üñ•Ô∏è –¢–µ—Ä–º–∏–Ω–∞–ª—ã</button>
            <button class="tab" onclick="switchTab('map-container')">üó∫Ô∏è –ö–∞—Ä—Ç–∞</button>
            <button class="tab" onclick="switchTab('reports')">üìà –û—Ç—á—ë—Ç—ã</button>
        </div>
    </div>
    
    <div class="content-area">
        <!-- –ì–ª–∞–≤–Ω–∞—è -->
        <div id="dashboard" class="tab-content active">
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>–ê–ö–¢–ò–í–ù–´–ï –ó–ê–Ø–í–ö–ò</h3>
                    <div class="value" id="total-requests">0</div>
                    <div class="change">‚Üë +2 –∑–∞ —Å–µ–≥–æ–¥–Ω—è</div>
                </div>
                <div class="stat-card">
                    <h3>–û–ñ–ò–î–ê–Æ–¢ –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ò–Ø</h3>
                    <div class="value" id="pending-requests">0</div>
                    <div class="change">–¢—Ä–µ–±—É—é—Ç –≤–Ω–∏–º–∞–Ω–∏—è</div>
                </div>
                <div class="stat-card">
                    <h3>–ü–û–î–¢–í–ï–†–ñ–î–ï–ù–û</h3>
                    <div class="value" id="confirmed-requests">0</div>
                    <div class="change">‚Üë +5 –∑–∞ –Ω–µ–¥–µ–ª—é</div>
                </div>
                <div class="stat-card">
                    <h3>–í–°–ï–ì–û –°–ò–ì–ù–ê–õ–û–í</h3>
                    <div class="value" id="total-signals">0</div>
                    <div class="change">–ó–∞ —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü</div>
                </div>
            </div>
            
            <div style="background: #e6fffa; border: 2px solid #38b2ac; border-radius: 10px; padding: 20px; margin-bottom: 20px;">
                <h3 style="color: #234e52; margin-bottom: 10px;">–°—Ç–∞—Ç—É—Å –∞–≤—Ç–æ–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è</h3>
                <p>–†–µ–∂–∏–º: <strong id="auto-confirm-status">–û–¢–ö–õ–Æ–ß–ï–ù</strong></p>
                <button class="btn btn-primary" onclick="toggleAutoConfirm()">–ò–∑–º–µ–Ω–∏—Ç—å —Ä–µ–∂–∏–º</button>
            </div>
            
            <div class="map-controls">
                <button class="btn btn-primary" onclick="processEmailQueue()">üìß –û–±—Ä–∞–±–æ—Ç–∞—Ç—å email –æ—á–µ—Ä–µ–¥—å</button>
                <button class="btn btn-primary" onclick="syncWithPoiskMore()">üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –ü–æ–∏—Å–∫-–ú–æ—Ä–µ</button>
                <button class="btn btn-secondary" onclick="generateTestData()">üé≤ –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ</button>
                <button class="btn btn-secondary" onclick="systemHealthCheck()">üè• –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã</button>
            </div>
        </div>
        
        <!-- –ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞ -->
        <div id="new-request" class="tab-content">
            <h2>–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∑–∞—è–≤–∫–∏ –Ω–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –°–°–¢–û</h2>
            <form id="request-form">
                <div class="form-group highlight">
                    <label>‚ö†Ô∏è –ù–û–ú–ï–† –°–¢–û–ô–ö–ò –°–°–¢–û (–ì–õ–ê–í–ù–´–ô –ò–î–ï–ù–¢–ò–§–ò–ö–ê–¢–û–†) *</label>
                    <input type="text" id="station-number" name="station-number" required pattern="[0-9]{9}" 
                           placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 427309676" maxlength="9">
                    <small style="color: #d32f2f;">–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥–ª—è —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è</small>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                    <div class="form-group">
                        <label>–¢–∏–ø —Å–ø—É—Ç–Ω–∏–∫–æ–≤–æ–π —Å–≤—è–∑–∏ *</label>
                        <div>
                            <label><input type="radio" name="satcom-type" value="INMARSAT" checked> –ò–ù–ú–ê–†–°–ê–¢</label>
                            <label><input type="radio" name="satcom-type" value="IRIDIUM"> –ò–†–ò–î–ò–£–ú</label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>–ù–∞–∑–≤–∞–Ω–∏–µ —Å—É–¥–Ω–∞ *</label>
                        <input type="text" id="vessel-name" name="vessel-name" required>
                    </div>
                    
                    <div class="form-group">
                        <label>MMSI *</label>
                        <input type="text" id="mmsi" name="mmsi" required pattern="[0-9]{9}" maxlength="9">
                    </div>
                    
                    <div class="form-group">
                        <label>IMO</label>
                        <input type="text" id="imo" name="imo" pattern="[0-9]{7}" maxlength="7">
                    </div>
                    
                    <div class="form-group">
                        <label>–°—É–¥–æ–≤–ª–∞–¥–µ–ª–µ—Ü *</label>
                        <input type="text" id="ship-owner" name="ship-owner" required>
                    </div>
                    
                    <div class="form-group">
                        <label>Email *</label>
                        <input type="email" id="email" name="email" required>
                    </div>
                    
                    <div class="form-group">
                        <label>–î–∞—Ç–∞ —Ç–µ—Å—Ç–∞ *</label>
                        <input type="date" id="test-date" name="test-date" required>
                    </div>
                    
                    <div class="form-group">
                        <label>–í—Ä–µ–º—è —Ç–µ—Å—Ç–∞</label>
                        <input type="time" id="test-time" name="test-time">
                    </div>
                </div>
                
                <button type="submit" class="btn btn-primary" style="margin-top: 20px;">–°–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É</button>
            </form>
        </div>
        
        <!-- –ó–∞—è–≤–∫–∏ -->
        <div id="requests" class="tab-content">
            <h2>–°–ø–∏—Å–æ–∫ –∑–∞—è–≤–æ–∫ –Ω–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</h2>
            <table>
                <thead>
                    <tr>
                    <th>ID</th>
                    <th>–ù–æ–º–µ—Ä —Å—Ç–æ–π–∫–∏</th>
                    <th>–°—É–¥–Ω–æ</th>
                    <th>MMSI</th>
                    <th>IMO</th>
                    <th>–î–∞—Ç–∞ —Ç–µ—Å—Ç–∞</th>
                    <th>–°—Ç–∞—Ç—É—Å</th>
                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                </tr>
                </thead>
                <tbody id="requests-tbody">
                    <!-- –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </tbody>
            </table>
        </div>
        
        <!-- –°–∏–≥–Ω–∞–ª—ã -->
        <div id="signals" class="tab-content">
            <h2>–ü–æ–ª—É—á–µ–Ω–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã –°–°–¢–û</h2>
            <table>
                <thead>
                    <tr>
                    <th>ID</th>
                    <th>–ù–æ–º–µ—Ä —Å—Ç–æ–π–∫–∏</th>
                    <th>–°—É–¥–Ω–æ</th>
                    <th>MMSI</th>
                    <th>IMO</th>
                    <th>–¢–∏–ø</th>
                    <th>–í—Ä–µ–º—è –ø–æ–ª—É—á–µ–Ω–∏—è</th>
                    <th>–¢–µ—Å—Ç/–¢—Ä–µ–≤–æ–≥–∞</th>
                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                </tr>
                </thead>
                <tbody id="signals-tbody">
                    <!-- –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </tbody>
            </table>
        </div>
        
        <!-- –¢–µ—Ä–º–∏–Ω–∞–ª—ã -->
        <div id="terminals" class="tab-content">
            <h2>–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Ç–µ—Ä–º–∏–Ω–∞–ª–æ–≤ –°–°–¢–û</h2>
            <div class="map-controls">
                <button class="btn btn-primary" onclick="addNewTerminal()">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Ä–º–∏–Ω–∞–ª</button>
                <button class="btn btn-secondary" onclick="app.vesselDB.exportToCSV()">üì• –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV</button>
            </div>
            <table>
                <thead>
                    <tr>
                        <th>–ù–æ–º–µ—Ä —Å—Ç–æ–π–∫–∏</th>
                        <th>–°—É–¥–Ω–æ</th>
                        <th>MMSI</th>
                        <th>–¢–∏–ø —Å–≤—è–∑–∏</th>
                        <th>–í–ª–∞–¥–µ–ª–µ—Ü</th>
                        <th>–ü–æ—Å–ª–µ–¥–Ω–∏–π —Ç–µ—Å—Ç</th>
                        <th>–°–ª–µ–¥—É—é—â–∏–π —Ç–µ—Å—Ç</th>
                        <th>–°—Ç–∞—Ç—É—Å</th>
                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                    </tr>
                </thead>
                <tbody id="terminals-tbody">
                    <!-- –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </tbody>
            </table>
        </div>
        
        <!-- –ö–∞—Ä—Ç–∞ -->
        <div id="map-container" class="tab-content">
            <h2>–ö–∞—Ä—Ç–∞ —Å–∏–≥–Ω–∞–ª–æ–≤ –°–°–¢–û</h2>
            <div id="map"></div>
            <div class="map-controls">
                <button class="btn btn-primary" onclick="window.mapManager.zoomToSignals()">üéØ –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ</button>
                <button class="btn btn-primary" onclick="window.mapManager.measureDistance()">üìè –ò–∑–º–µ—Ä–∏—Ç—å</button>
                <button class="btn btn-secondary" onclick="window.mapManager.exportMapImage()">üì∑ –°–∫—Ä–∏–Ω—à–æ—Ç</button>
                <button class="btn btn-secondary" onclick="window.mapManager.clearMap()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
            </div>
        </div>
        
        <!-- –û—Ç—á—ë—Ç—ã -->
        <div id="reports" class="tab-content">
            <h2>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–æ–≤</h2>
            <div class="form-group">
                <label>–¢–∏–ø –æ—Ç—á—ë—Ç–∞</label>
                <select id="report-type">
                    <option value="daily">–°—É—Ç–æ—á–Ω—ã–π</option>
                    <option value="weekly">–ù–µ–¥–µ–ª—å–Ω—ã–π</option>
                    <option value="monthly">–ú–µ—Å—è—á–Ω—ã–π</option>
                    <option value="custom">–ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –ø–µ—Ä–∏–æ–¥</option>
                </select>
            </div>
            <div class="map-controls">
                <button class="btn btn-primary" onclick="generateDailyReport()">üìä –°—É—Ç–æ—á–Ω—ã–π –æ—Ç—á—ë—Ç</button>
                <button class="btn btn-primary" onclick="generateWeeklyReport()">üìä –ù–µ–¥–µ–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç</button>
                <button class="btn btn-primary" onclick="generateMonthlyReport()">üìä –ú–µ—Å—è—á–Ω—ã–π –æ—Ç—á—ë—Ç</button>
                <button class="btn btn-secondary" onclick="exportReportToPDF()">üìÑ –≠–∫—Å–ø–æ—Ä—Ç –≤ PDF</button>
            </div>
            <div id="report-content" style="margin-top: 20px;">
                <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –æ—Ç—á—ë—Ç–∞ -->
            </div>
        </div>
    </div>
    
    <!-- –°–∫—Ä—ã—Ç—ã–π input –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ Excel -->
    <input type="file" id="excel-upload" accept=".xlsx,.xls,.csv">
    
    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –±—É–¥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
    
    <script>
        // ===== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø =====
        const app = {
            autoConfirmManager: null,
            emailProcessor: null,
            poiskMoreIntegration: null,
            vesselDB: null,
            map: null,
            markers: [],
            currentTab: 'dashboard',
            filters: {
                dateFrom: null,
                dateTo: null,
                status: 'all',
                vesselMMSI: null,
                signalType: 'all'
            }
        };

        // ===== –ö–õ–ê–°–° VesselDB - –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å—É–¥–æ–≤ =====
        class VesselDB {
            constructor() {
                this.vessels = JSON.parse(localStorage.getItem('vessels') || '[]');
                this.initDefaultVessels();
            }

            initDefaultVessels() {
                if (this.vessels.length === 0) {
                    this.vessels = [
                        {
                            id: 'V001',
                            name: '–ê–ö–ê–î–ï–ú–ò–ö –õ–û–ú–û–ù–û–°–û–í',
                            mmsi: '273456789',
                            imo: '9876543',
                            callSign: 'UBXR',
                            flag: 'RU',
                            type: 'Research Vessel',
                            stationNumbers: ['427309676', '427309677'],
                            owner: '–†–æ—Å—Å–∏–π—Å–∫–∞—è –ê–∫–∞–¥–µ–º–∏—è –ù–∞—É–∫',
                            operator: '–†–ê–ù –§–ª–æ—Ç',
                            email: 'fleet@ras.ru',
                            satcomType: 'INMARSAT',
                            lastTest: '2025-01-15T10:00:00Z',
                            nextTest: '2025-02-15T10:00:00Z',
                            status: 'ACTIVE'
                        },
                        {
                            id: 'V002',
                            name: '–ö–ê–ü–ò–¢–ê–ù –í–û–†–û–ù–ò–ù',
                            mmsi: '273456790',
                            imo: '9876544',
                            callSign: 'UBXS',
                            flag: 'RU',
                            type: 'Cargo',
                            stationNumbers: ['427309678'],
                            owner: '–°–µ–≤–µ—Ä–Ω–æ–µ –ú–æ—Ä—Å–∫–æ–µ –ü–∞—Ä–æ—Ö–æ–¥—Å—Ç–≤–æ',
                            operator: '–°–ú–ü',
                            email: 'dispatch@smp.ru',
                            satcomType: 'IRIDIUM',
                            lastTest: '2025-01-20T14:00:00Z',
                            nextTest: '2025-02-20T14:00:00Z',
                            status: 'ACTIVE'
                        }
                    ];
                    this.save();
                }
            }

            save() {
                localStorage.setItem('vessels', JSON.stringify(this.vessels));
            }

            findByStationNumber(stationNumber) {
                return this.vessels.find(v => 
                    v.stationNumbers && v.stationNumbers.includes(stationNumber)
                );
            }

            findByMMSI(mmsi) {
                return this.vessels.find(v => v.mmsi === mmsi);
            }

            addVessel(vessel) {
                vessel.id = `V${Date.now()}`;
                vessel.createdAt = new Date().toISOString();
                vessel.status = vessel.status || 'ACTIVE';
                this.vessels.push(vessel);
                this.save();
                return vessel;
            }

            exportToCSV() {
                const headers = ['ID', '–ù–∞–∑–≤–∞–Ω–∏–µ', 'MMSI', 'IMO', '–ü–æ–∑—ã–≤–Ω–æ–π', '–ù–æ–º–µ—Ä–∞ —Å—Ç–æ–µ–∫', '–í–ª–∞–¥–µ–ª–µ—Ü', 'Email', '–¢–∏–ø —Å–≤—è–∑–∏', '–°—Ç–∞—Ç—É—Å'];
                const rows = this.vessels.map(v => [
                    v.id,
                    v.name,
                    v.mmsi,
                    v.imo || '',
                    v.callSign || '',
                    (v.stationNumbers || []).join(';'),
                    v.owner || '',
                    v.email || '',
                    v.satcomType || '',
                    v.status
                ]);

                const csvContent = [
                    headers.join(','),
                    ...rows.map(row => row.map(cell => `"${cell}"`).join(','))
                ].join('\n');

                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `vessels_${Date.now()}.csv`;
                link.click();
                URL.revokeObjectURL(url);
            }

            getActiveVessels() {
                return this.vessels.filter(v => v.status === 'ACTIVE');
            }
        }

        // ===== –ö–õ–ê–°–° AutoConfirmationManager =====
        class AutoConfirmationManager {
            constructor() {
                this.enabled = localStorage.getItem('autoConfirmEnabled') === 'true';
                this.adminPassword = 'Admin@SSTO2025';
            }

            toggleAutoConfirmation(password, reason, userId) {
                if (password !== this.adminPassword) {
                    throw new Error('–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞');
                }

                this.enabled = !this.enabled;
                localStorage.setItem('autoConfirmEnabled', this.enabled.toString());

                return {
                    success: true,
                    enabled: this.enabled,
                    message: `–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ ${this.enabled ? '–≤–∫–ª—é—á–µ–Ω–æ' : '–æ—Ç–∫–ª—é—á–µ–Ω–æ'}`
                };
            }

            processSignal(signal) {
                if (!this.enabled) {
                    return { processed: false, reason: '–ê–≤—Ç–æ–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ—Ç–∫–ª—é—á–µ–Ω–æ' };
                }

                const requests = JSON.parse(localStorage.getItem('testRequests') || '[]');
                const matchingRequest = requests.find(req => 
                    req.stationNumber === signal.stationNumber &&
                    req.status === 'pending'
                );

                if (!matchingRequest) {
                    return { processed: false, reason: '–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∞—è –∑–∞—è–≤–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞' };
                }

                matchingRequest.status = 'confirmed';
                matchingRequest.confirmedAt = new Date().toISOString();
                
                localStorage.setItem('testRequests', JSON.stringify(requests));

                return {
                    processed: true,
                    requestId: matchingRequest.id
                };
            }
        }

// ===== –û–ë–ù–û–í–õ–ï–ù–ù–´–ô EmailProcessor —Å –ø–∞—Ä—Å–∏–Ω–≥–æ–º —Ä–µ–∞–ª—å–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ =====
class EmailProcessor {
    constructor() {
        this.emailQueue = JSON.parse(localStorage.getItem('emailQueue') || '[]');
        this.processedEmails = JSON.parse(localStorage.getItem('processedEmails') || '[]');
        this.emailPatterns = {
            // –ü–∞—Ç—Ç–µ—Ä–Ω—ã –∏–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
            testSignal: /---TEST SSAS TEST---|TEST SSAS/i,
            mobileTerminal: /Mobile Terminal No[:\s]*(\d{9})/i,
            stationNumber: /Station Number[:\s]*(\d{9})|Mobile Terminal No[:\s]*(\d{9})/i,
            position: /Position[:\s]*([\d.]+)[NS]\s*([\d.]+)[EW]/i,
            coordinates: /(\d+\.?\d*)[NS]\s+(\d+\.?\d*)[EW]/i,
            utcTime: /(\d{4}-\d{2}-\d{2})\s+(\d{2}:\d{2}:\d{2})/i,
            mmsi: /MMSI[:\s]*(\d{9})|(\d{9})\s+\d{4}-\d{2}-\d{2}/i,
            vesselName: /Vessel[:\s]*([A-Za-z–ê-–Ø–∞-—è\s\-]+)/i
        };
    }

    parseIncomingEmail(emailContent, emailFrom, emailSubject) {
        console.log('–ü–∞—Ä—Å–∏–Ω–≥ –≤—Ö–æ–¥—è—â–µ–≥–æ email:', emailSubject);
        
        const signal = {
            id: `SIG-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,
            receivedAt: new Date().toISOString(),
            emailFrom: emailFrom,
            emailSubject: emailSubject,
            rawContent: emailContent,
            isTest: false,
            type: 'UNKNOWN',
            stationNumber: null,
            mmsi: null,
            vesselName: null,
            coordinates: null,
            positionTime: null
        };

        // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞
        if (this.emailPatterns.testSignal.test(emailContent)) {
            signal.isTest = true;
            signal.type = 'TEST';
        }

        // –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–∞ —Å—Ç–æ–π–∫–∏/—Ç–µ—Ä–º–∏–Ω–∞–ª–∞
        const stationMatch = emailContent.match(this.emailPatterns.stationNumber);
        if (stationMatch) {
            signal.stationNumber = stationMatch[1] || stationMatch[2];
            console.log('–ù–∞–π–¥–µ–Ω –Ω–æ–º–µ—Ä —Å—Ç–æ–π–∫–∏:', signal.stationNumber);
        }

        // –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ MMSI
        const mmsiMatch = emailContent.match(this.emailPatterns.mmsi);
        if (mmsiMatch) {
            signal.mmsi = mmsiMatch[1] || mmsiMatch[2];
        }

        // –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
        const coordMatch = emailContent.match(this.emailPatterns.coordinates);
        if (coordMatch) {
            signal.coordinates = {
                lat: parseFloat(coordMatch[1]),
                lon: parseFloat(coordMatch[2])
            };
        }

        // –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ UTC
        const timeMatch = emailContent.match(this.emailPatterns.utcTime);
        if (timeMatch) {
            signal.positionTime = `${timeMatch[1]}T${timeMatch[2]}Z`;
        }

        // –ü–æ–ø—ã—Ç–∫–∞ –Ω–∞–π—Ç–∏ —Å—É–¥–Ω–æ –≤ –±–∞–∑–µ
        if (signal.stationNumber) {
            const vessel = app.vesselDB.findByStationNumber(signal.stationNumber);
            if (vessel) {
                signal.vesselName = vessel.name;
                signal.mmsi = signal.mmsi || vessel.mmsi;
                signal.type = vessel.satcomType;
            }
        }

        return signal;
    }

    processTestSignalEmail(emailContent) {
        // –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ —Ñ–æ—Ä–º–∞—Ç–∞ –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞
        const testData = {
            stationNumber: null,
            position: null,
            time: null,
            mmsi: null
        };

        // –ü–∞—Ä—Å–∏–Ω–≥ –ø–æ –æ–±—Ä–∞–∑—Ü—É:
        // Mobile Terminal No:427305964
        // Position:41 28.83N 31 47.83'E
        // Position updated:08:26 2025-03-18 UTC
        
        const lines = emailContent.split('\n');
        lines.forEach(line => {
            if (line.includes('Mobile Terminal No')) {
                const match = line.match(/(\d{9})/);
                if (match) testData.stationNumber = match[1];
            }
            if (line.includes('Position:')) {
                const match = line.match(/([\d.]+)\s*[NS]\s*([\d.]+)\s*[EW]/);
                if (match) {
                    testData.position = {
                        lat: parseFloat(match[1]),
                        lon: parseFloat(match[2])
                    };
                }
            }
            if (line.includes('Position updated') || line.includes('UTC')) {
                const match = line.match(/(\d{2}:\d{2})\s+(\d{4}-\d{2}-\d{2})/);
                if (match) {
                    testData.time = `${match[2]}T${match[1]}:00Z`;
                }
            }
            if (line.match(/^\d{9}\s+\d{4}-\d{2}-\d{2}/)) {
                const match = line.match(/^(\d{9})/);
                if (match) testData.mmsi = match[1];
            }
        });

        return testData;
    }

    async simulateIncomingEmail() {
        // –°–∏–º—É–ª—è—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è email –∫–∞–∫ –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞
        const testEmail = `---TEST SSAS TEST---
Mobile Terminal No:427305964
Position:41 28.83N 31 47.83'E
Position updated:08:26 2025-03-18 UTC
---TEST SSAS TEST---
009598830 2025-03-18 08:26:42
41.28N 31.47E
2025-03-18 08:26:42
Coverage message setup:
E-mail:od_gmrcc@morflot.ru
E-mail:uvdp@volgaflot.com
E-mail:sb-tech@volgaflot.com`;

        const signal = this.parseIncomingEmail(
            testEmail,
            'ssas@inmarsat.com',
            'TEST SSAS ALERT'
        );

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∞
        const signals = JSON.parse(localStorage.getItem('signals') || '[]');
        signals.push(signal);
        localStorage.setItem('signals', JSON.stringify(signals));

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
        if (app.autoConfirmManager && app.autoConfirmManager.enabled) {
            const result = app.autoConfirmManager.processSignal(signal);
            if (result.processed) {
                // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
                await this.generateOfficialConfirmation(signal, result.requestId);
            }
        }

        showNotification(`üìß –ü–æ–ª—É—á–µ–Ω —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∏–≥–Ω–∞–ª –æ—Ç —Å—Ç–æ–π–∫–∏ ${signal.stationNumber}`, 'info');
        loadSignals();
        
        return signal;
    }

    async generateOfficialConfirmation(signal, requestId) {
        const request = JSON.parse(localStorage.getItem('testRequests') || '[]')
            .find(r => r.id === requestId);
        
        if (!request) return;

        const vessel = app.vesselDB.findByStationNumber(signal.stationNumber);
        
        // –®–∞–±–ª–æ–Ω –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –ì–ú–°–ö–¶
        const confirmationHTML = `
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <style>
        body { font-family: 'Times New Roman', serif; margin: 40px; }
        .header { text-align: center; margin-bottom: 30px; }
        .header h3 { margin: 5px 0; font-size: 14px; }
        .doc-number { margin: 20px 0; }
        .content { margin: 30px 0; line-height: 1.6; }
        .signature { margin-top: 50px; }
        .details { margin: 20px 0; background: #f0f0f0; padding: 15px; }
        .details-line { margin: 5px 0; font-family: monospace; }
    </style>
</head>
<body>
    <div class="header">
        <h3>–ú–ò–ù–¢–†–ê–ù–° –†–û–°–°–ò–ò</h3>
        <h3>–†–û–°–ú–û–†–†–ï–ß–§–õ–û–¢</h3>
        <h3>–§–ï–î–ï–†–ê–õ–¨–ù–û–ï –ì–û–°–£–î–ê–†–°–¢–í–ï–ù–ù–û–ï –ë–Æ–î–ñ–ï–¢–ù–û–ï –£–ß–†–ï–ñ–î–ï–ù–ò–ï</h3>
        <h3>¬´–ú–û–†–°–ö–ê–Ø –°–ü–ê–°–ê–¢–ï–õ–¨–ù–ê–Ø –°–õ–£–ñ–ë–ê¬ª</h3>
        <h3>(–§–ì–ë–£ ¬´–ú–û–†–°–ü–ê–°–°–õ–£–ñ–ë–ê¬ª)</h3>
        <p style="font-size: 12px;">
            —É–ª. –ü–µ—Ç—Ä–æ–≤–∫–∞ –¥. 3/6 —Å—Ç—Ä. 2, –≥. –ú–æ—Å–∫–≤–∞, 125993<br>
            —Ç–µ–ª.: (495) 626-18-08<br>
            info@morspas.ru, www.morspas.ru<br>
            –û–ö–ü–û 18685292, –û–ì–†–ù 1027739737321<br>
            –ò–ù–ù/–ö–ü–ü 7707274249/770701001
        </p>
        <h3>–ì–ª–∞–≤–Ω—ã–π –º–æ—Ä—Å–∫–æ–π —Å–ø–∞—Å–∞—Ç–µ–ª—å–Ω–æ-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä (–ì–ú–°–ö–¶)</h3>
    </div>

    <div class="doc-number">
        <strong>‚Ññ –ú–°–°-${request.id.replace('REQ-', '')}</strong><br>
        –æ—Ç ${new Date().toLocaleDateString('ru-RU')}
    </div>

    <div class="content">
        <p><strong>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ–º –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –°–°–¢–û:</strong></p>
        
        <div class="details">
            <div class="details-line">---TEST SSAS TEST---</div>
            <div class="details-line">Mobile Terminal No:${signal.stationNumber}</div>
            <div class="details-line">Position:${signal.coordinates ? 
                signal.coordinates.lat + 'N ' + signal.coordinates.lon + 'E' : '–ù–µ —É–∫–∞–∑–∞–Ω–∞'}</div>
            <div class="details-line">Position updated:${formatDate(signal.positionTime || signal.receivedAt)}</div>
            <div class="details-line">---TEST SSAS TEST---</div>
            <div class="details-line">${signal.mmsi || '000000000'} ${new Date().toISOString().split('T')[0]}</div>
            <div class="details-line">Vessel: ${vessel ? vessel.name : '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ'}</div>
        </div>

        <p>Coverage message setup:</p>
        <p>E-mail: od_gmrcc@morflot.ru<br>
           E-mail: ${request.email}<br>
           ${vessel && vessel.operator ? `E-mail: ${vessel.operator}@volgaflot.com` : ''}
        </p>
    </div>

    <div class="signature">
        <p>–ü–æ–¥–ø–∏—Å–∞–Ω–æ –ü–≠–ü</p>
        <p><strong>–°.–ê. –ú–æ—Ö–Ω–∞—á–µ–≤</strong></p>
        <p>–û–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–π –¥–µ–∂—É—Ä–Ω—ã–π –ì–ú–°–ö–¶</p>
        <p>${new Date().toLocaleDateString('ru-RU')}</p>
        <br>
        <p>–û–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–π –¥–µ–∂—É—Ä–Ω—ã–π –ì–ú–°–ö–¶<br>
        +7 (495) 626-10-52</p>
    </div>
</body>
</html>
        `;

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
        const confirmation = {
            id: `CONF-${Date.now()}`,
            requestId: requestId,
            signalId: signal.id,
            html: confirmationHTML,
            createdAt: new Date().toISOString(),
            documentNumber: `–ú–°–°-${request.id.replace('REQ-', '')}`,
            signedBy: '–°.–ê. –ú–æ—Ö–Ω–∞—á–µ–≤'
        };

        const confirmations = JSON.parse(localStorage.getItem('confirmations') || '[]');
        confirmations.push(confirmation);
        localStorage.setItem('confirmations', JSON.stringify(confirmations));

        // –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ email –µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ
        if (window.emailSender && window.emailSender.enabled) {
            await window.emailSender.sendOfficialConfirmation(confirmation, request, vessel);
        }

        return confirmation;
    }
}

// –î–æ–±–∞–≤—å—Ç–µ —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
function viewConfirmation(requestId) {
    const confirmations = JSON.parse(localStorage.getItem('confirmations') || '[]');
    const confirmation = confirmations.find(c => c.requestId === requestId);
    
    if (!confirmation) {
        showNotification('–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ', 'error');
        return;
    }
    
    // –û—Ç–∫—Ä—ã—Ç–∏–µ –≤ –Ω–æ–≤–æ–º –æ–∫–Ω–µ
    const win = window.open('', '_blank');
    win.document.write(confirmation.html);
    win.document.close();
}

// –î–æ–±–∞–≤—å—Ç–µ –∫–Ω–æ–ø–∫—É –¥–ª—è —Å–∏–º—É–ª—è—Ü–∏–∏ –ø–æ–ª—É—á–µ–Ω–∏—è email –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
function addEmailTestButton() {
    const dashboardActions = document.querySelector('#dashboard .map-controls');
    if (dashboardActions) {
        const button = document.createElement('button');
        button.className = 'btn btn-primary';
        button.innerHTML = 'üì® –°–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –≤—Ö–æ–¥—è—â–∏–π —Å–∏–≥–Ω–∞–ª';
        button.onclick = () => app.emailProcessor.simulateIncomingEmail();
        dashboardActions.appendChild(button);
    }
}

// –í—ã–∑–æ–≤–∏—Ç–µ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
document.addEventListener('DOMContentLoaded', () => {
    addEmailTestButton();
});

        // ===== –ö–õ–ê–°–° PoiskMoreIntegration =====
        class PoiskMoreIntegration {
            constructor() {
                this.syncEnabled = localStorage.getItem('poiskMoreSyncEnabled') === 'true';
            }

            async sendToPoiskMore(signal) {
                // –ò–º–∏—Ç–∞—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏
                return {
                    success: true,
                    poiskMoreId: `PM-${Date.now()}`,
                    message: '–°–∏–≥–Ω–∞–ª –ø–µ—Ä–µ–¥–∞–Ω –≤ –ü–æ–∏—Å–∫-–ú–æ—Ä–µ'
                };
            }

            async syncBatch(signals) {
                const results = [];
                for (const signal of signals) {
                    const result = await this.sendToPoiskMore(signal);
                    results.push(result);
                }
                return results;
            }
        }

        // ===== –ö–õ–ê–°–° AdvancedMapManager =====
        class AdvancedMapManager {
            constructor() {
                this.map = null;
                this.vectorSource = null;
            }

            initAdvancedMap() {
                if (!document.getElementById('map')) return;

                this.map = new ol.Map({
                    target: 'map',
                    layers: [
                        new ol.layer.Tile({
                            source: new ol.source.OSM()
                        })
                    ],
                    view: new ol.View({
                        center: ol.proj.fromLonLat([37.6173, 55.7558]),
                        zoom: 5
                    })
                });

                this.vectorSource = new ol.source.Vector();
                const vectorLayer = new ol.layer.Vector({
                    source: this.vectorSource
                });
                this.map.addLayer(vectorLayer);

                this.loadSignalsToMap();
            }

            loadSignalsToMap() {
                const signals = JSON.parse(localStorage.getItem('signals') || '[]');
                this.vectorSource.clear();
                
                signals.forEach(signal => {
                    if (signal.coordinates) {
                        const feature = new ol.Feature({
                            geometry: new ol.geom.Point(
                                ol.proj.fromLonLat([signal.coordinates.lon, signal.coordinates.lat])
                            )
                        });
                        
                        const iconStyle = new ol.style.Style({
                            image: new ol.style.Circle({
                                radius: 8,
                                fill: new ol.style.Fill({
                                    color: signal.isTest ? 'rgba(0, 255, 0, 0.6)' : 'rgba(255, 0, 0, 0.6)'
                                }),
                                stroke: new ol.style.Stroke({
                                    color: signal.isTest ? 'green' : 'red',
                                    width: 2
                                })
                            })
                        });
                        
                        feature.setStyle(iconStyle);
                        this.vectorSource.addFeature(feature);
                    }
                });
            }

            zoomToSignals() {
                if (!this.vectorSource) return;
                const extent = this.vectorSource.getExtent();
                if (!ol.extent.isEmpty(extent)) {
                    this.map.getView().fit(extent, {
                        padding: [50, 50, 50, 50],
                        duration: 1000
                    });
                }
            }

            measureDistance() {
                alert('–§—É–Ω–∫—Ü–∏—è –∏–∑–º–µ—Ä–µ–Ω–∏—è —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞');
            }

            exportMapImage() {
                alert('–≠–∫—Å–ø–æ—Ä—Ç –∫–∞—Ä—Ç—ã –≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ');
            }

            clearMap() {
                if (this.vectorSource) {
                    this.vectorSource.clear();
                }
            }
        }

        // ===== –ö–õ–ê–°–° EmailAutoSender =====
// ===== –ö–õ–ê–°–° EmailAutoSender –° –ü–û–õ–ù–û–ô –ù–ê–°–¢–†–û–ô–ö–û–ô =====
class EmailAutoSender {
    constructor() {
        this.enabled = localStorage.getItem('emailAutoSendEnabled') === 'true';
        this.smtp = {
            host: localStorage.getItem('smtpHost') || 'smtp.gmail.com',
            port: localStorage.getItem('smtpPort') || '587',
            user: localStorage.getItem('smtpUser') || '',
            pass: localStorage.getItem('smtpPass') || '',
            from: localStorage.getItem('smtpFrom') || 'ssto@morflot.ru',
            secure: localStorage.getItem('smtpSecure') === 'true'
        };
        this.templates = this.loadTemplates();
        this.queue = JSON.parse(localStorage.getItem('emailQueue') || '[]');
    }

    loadTemplates() {
        const saved = localStorage.getItem('emailTemplates');
        if (saved) return JSON.parse(saved);
        
        return {
            testConfirmation: {
                subject: '–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞ –°–°–¢–û - {{vesselName}}',
                body: `
–§–ì–ë–£ ¬´–ú–û–†–°–ü–ê–°–°–õ–£–ñ–ë–ê¬ª
–ì–ª–∞–≤–Ω—ã–π –º–æ—Ä—Å–∫–æ–π —Å–ø–∞—Å–∞—Ç–µ–ª—å–Ω–æ-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä

–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ–º –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞ –æ—Ç —Å–∏—Å—Ç–µ–º—ã –°–°–¢–û

–î–µ—Ç–∞–ª–∏ —Ç–µ—Å—Ç–∞:
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
–°—É–¥–Ω–æ: {{vesselName}}
MMSI: {{mmsi}}
IMO: {{imo}}
–ù–æ–º–µ—Ä —Å—Ç–æ–π–∫–∏ –°–°–¢–û: {{stationNumber}}
–¢–∏–ø —Å–∏—Å—Ç–µ–º—ã: {{satcomType}}
–î–∞—Ç–∞/–≤—Ä–µ–º—è —Ç–µ—Å—Ç–∞: {{testDate}}
–î–∞—Ç–∞/–≤—Ä–µ–º—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–∏–≥–Ω–∞–ª–∞: {{receivedAt}}
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

–†–µ–∑—É–ª—å—Ç–∞—Ç: ‚úÖ –¢–ï–°–¢ –£–°–ü–ï–®–ù–û –ü–†–û–ô–î–ï–ù

–°–∏–≥–Ω–∞–ª –ø–æ–ª—É—á–µ–Ω –∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –ø—Ä–æ—Ü–µ–¥—É—Ä–∞–º–∏.

–° —É–≤–∞–∂–µ–Ω–∏–µ–º,
–û–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–π –¥–µ–∂—É—Ä–Ω—ã–π –ì–ú–°–ö–¶
–¢–µ–ª: +7 (495) 626-10-52
Email: gmskc@morflot.ru

---
–≠—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –¢–ï–°–¢ –°–°–¢–û.
                `
            }
        };
    }

    configureSMTP() {
        // –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
        const modal = document.createElement('div');
        modal.className = 'modal active';
        modal.innerHTML = `
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ Email</div>
                    <button class="modal-close" onclick="this.closest('.modal').remove()">√ó</button>
                </div>
                <div style="padding: 20px;">
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="email-auto-send" ${this.enabled ? 'checked' : ''}>
                            –í–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –æ—Ç–ø—Ä–∞–≤–∫—É –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π
                        </label>
                    </div>
                    
                    <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ SMTP —Å–µ—Ä–≤–µ—Ä–∞</h3>
                    
                    <div class="form-group">
                        <label>SMTP —Å–µ—Ä–≤–µ—Ä</label>
                        <input type="text" id="smtp-host" value="${this.smtp.host}" placeholder="smtp.gmail.com">
                    </div>
                    
                    <div class="form-group">
                        <label>–ü–æ—Ä—Ç</label>
                        <input type="text" id="smtp-port" value="${this.smtp.port}" placeholder="587">
                    </div>
                    
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="smtp-secure" ${this.smtp.secure ? 'checked' : ''}>
                            –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SSL/TLS
                        </label>
                    </div>
                    
                    <div class="form-group">
                        <label>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (email)</label>
                        <input type="email" id="smtp-user" value="${this.smtp.user}" placeholder="user@domain.ru">
                    </div>
                    
                    <div class="form-group">
                        <label>–ü–∞—Ä–æ–ª—å</label>
                        <input type="password" id="smtp-pass" value="${this.smtp.pass}" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                    </div>
                    
                    <div class="form-group">
                        <label>Email –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è</label>
                        <input type="email" id="smtp-from" value="${this.smtp.from}" placeholder="ssto@morflot.ru">
                    </div>
                    
                    <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏</h3>
                    
                    <div class="form-group">
                        <label>–ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø–∏—Å—å–º–∞–º–∏ (—Å–µ–∫)</label>
                        <input type="number" id="email-delay" value="${localStorage.getItem('emailDelay') || '5'}" min="1" max="60">
                    </div>
                    
                    <div class="form-group">
                        <label>–ö–æ–ø–∏—è –Ω–∞ email –ì–ú–°–ö–¶</label>
                        <input type="email" id="email-cc" value="${localStorage.getItem('emailCC') || 'gmskc@morflot.ru'}">
                    </div>
                    
                    <div style="background: #fff3cd; border: 2px solid #ffc107; border-radius: 8px; padding: 15px; margin: 20px 0;">
                        <strong>‚ö†Ô∏è –í–∞–∂–Ω–æ:</strong><br>
                        –î–ª—è —Ä–µ–∞–ª—å–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ email —Ç—Ä–µ–±—É–µ—Ç—Å—è backend —Å–µ—Ä–≤–µ—Ä.<br>
                        –í –¥–µ–º–æ-—Ä–µ–∂–∏–º–µ –ø–∏—Å—å–º–∞ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥—å –±–µ–∑ –æ—Ç–ø—Ä–∞–≤–∫–∏.
                    </div>
                    
                    <div class="map-controls">
                        <button class="btn btn-primary" onclick="window.emailSender.saveSettings()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                        <button class="btn btn-secondary" onclick="window.emailSender.testConnection()">üîß –¢–µ—Å—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è</button>
                        <button class="btn btn-secondary" onclick="window.emailSender.viewQueue()">üìß –û—á–µ—Ä–µ–¥—å (${this.queue.length})</button>
                    </div>
                </div>
            </div>
        `;
        document.body.appendChild(modal);
    }

    saveSettings() {
        this.enabled = document.getElementById('email-auto-send').checked;
        this.smtp.host = document.getElementById('smtp-host').value;
        this.smtp.port = document.getElementById('smtp-port').value;
        this.smtp.secure = document.getElementById('smtp-secure').checked;
        this.smtp.user = document.getElementById('smtp-user').value;
        this.smtp.pass = document.getElementById('smtp-pass').value;
        this.smtp.from = document.getElementById('smtp-from').value;
        
        localStorage.setItem('emailAutoSendEnabled', this.enabled);
        localStorage.setItem('smtpHost', this.smtp.host);
        localStorage.setItem('smtpPort', this.smtp.port);
        localStorage.setItem('smtpSecure', this.smtp.secure);
        localStorage.setItem('smtpUser', this.smtp.user);
        localStorage.setItem('smtpPass', this.smtp.pass);
        localStorage.setItem('smtpFrom', this.smtp.from);
        localStorage.setItem('emailDelay', document.getElementById('email-delay').value);
        localStorage.setItem('emailCC', document.getElementById('email-cc').value);
        
        showNotification('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ email —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã', 'success');
        document.querySelector('.modal').remove();
    }

    testConnection() {
        if (!this.smtp.host || !this.smtp.user || !this.smtp.pass) {
            showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ SMTP', 'error');
            return;
        }
        
        // –í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –∑–¥–µ—Å—å –±—ã–ª –±—ã –∑–∞–ø—Ä–æ—Å –∫ backend
        showNotification('–î–µ–º–æ-—Ä–µ–∂–∏–º: —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ', 'info');
    }

    viewQueue() {
        const modal = document.createElement('div');
        modal.className = 'modal active';
        modal.innerHTML = `
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title">üìß –û—á–µ—Ä–µ–¥—å –æ—Ç–ø—Ä–∞–≤–∫–∏ Email</div>
                    <button class="modal-close" onclick="this.closest('.modal').remove()">√ó</button>
                </div>
                <div style="padding: 20px;">
                    <table style="width: 100%;">
                        <thead>
                            <tr>
                                <th>–î–∞—Ç–∞</th>
                                <th>–ö–æ–º—É</th>
                                <th>–¢–µ–º–∞</th>
                                <th>–°—Ç–∞—Ç—É—Å</th>
                                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${this.queue.map(email => `
                                <tr>
                                    <td>${new Date(email.createdAt).toLocaleString('ru-RU')}</td>
                                    <td>${email.to}</td>
                                    <td>${email.subject}</td>
                                    <td><span class="status-badge status-${email.status}">${email.status}</span></td>
                                    <td>
                                        <button onclick="window.emailSender.resendEmail('${email.id}')" class="btn btn-secondary">–ü–æ–≤—Ç–æ—Ä</button>
                                        <button onclick="window.emailSender.removeFromQueue('${email.id}')" class="btn btn-secondary">–£–¥–∞–ª–∏—Ç—å</button>
                                    </td>
                                </tr>
                            `).join('') || '<tr><td colspan="5">–û—á–µ—Ä–µ–¥—å –ø—É—Å—Ç–∞</td></tr>'}
                        </tbody>
                    </table>
                    <div class="map-controls" style="margin-top: 20px;">
                        <button class="btn btn-primary" onclick="window.emailSender.processQueue()">‚ñ∂Ô∏è –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ—á–µ—Ä–µ–¥—å</button>
                        <button class="btn btn-secondary" onclick="window.emailSender.clearQueue()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –æ—á–µ—Ä–µ–¥—å</button>
                    </div>
                </div>
            </div>
        `;
        document.body.appendChild(modal);
    }

    async sendConfirmation(request, signal) {
        if (!this.enabled) {
            console.log('–ê–≤—Ç–æ–æ—Ç–ø—Ä–∞–≤–∫–∞ email –æ—Ç–∫–ª—é—á–µ–Ω–∞');
            return { success: false, reason: '–ê–≤—Ç–æ–æ—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∞' };
        }

        const vessel = app.vesselDB.findByStationNumber(signal.stationNumber);
        if (!vessel || !vessel.email) {
            return { success: false, reason: 'Email —Å—É–¥–æ–≤–ª–∞–¥–µ–ª—å—Ü–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω' };
        }

        // –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —à–∞–±–ª–æ–Ω–∞
        const templateData = {
            vesselName: vessel.name,
            mmsi: vessel.mmsi,
            imo: vessel.imo || '–ù–µ —É–∫–∞–∑–∞–Ω',
            stationNumber: signal.stationNumber,
            satcomType: vessel.satcomType,
            testDate: formatDate(request.testDate),
            receivedAt: formatDate(signal.receivedAt)
        };

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —à–∞–±–ª–æ–Ω–∞
        let subject = this.templates.testConfirmation.subject;
        let body = this.templates.testConfirmation.body;
        
        for (const [key, value] of Object.entries(templateData)) {
            const regex = new RegExp(`{{${key}}}`, 'g');
            subject = subject.replace(regex, value);
            body = body.replace(regex, value);
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –ø–∏—Å—å–º–∞
        const email = {
            id: `EMAIL-${Date.now()}`,
            to: vessel.email,
            cc: localStorage.getItem('emailCC') || 'gmskc@morflot.ru',
            subject: subject,
            body: body,
            attachments: [],
            createdAt: new Date().toISOString(),
            status: 'pending',
            requestId: request.id,
            signalId: signal.id
        };

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –æ—á–µ—Ä–µ–¥—å
        this.queue.push(email);
        localStorage.setItem('emailQueue', JSON.stringify(this.queue));

        // –ü–æ–ø—ã—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏
        await this.processQueue();

        return {
            success: true,
            emailId: email.id,
            message: `Email –¥–æ–±–∞–≤–ª–µ–Ω –≤ –æ—á–µ—Ä–µ–¥—å –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–∞ ${vessel.email}`
        };
    }

    async processQueue() {
        const pending = this.queue.filter(e => e.status === 'pending');
        const delay = parseInt(localStorage.getItem('emailDelay') || '5') * 1000;
        
        for (const email of pending) {
            // –í –¥–µ–º–æ-—Ä–µ–∂–∏–º–µ –ø–æ–º–µ—á–∞–µ–º –∫–∞–∫ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ
            email.status = 'sent';
            email.sentAt = new Date().toISOString();
            
            showNotification(`üìß Email –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ ${email.to}`, 'success');
            
            // –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø–∏—Å—å–º–∞–º–∏
            await new Promise(resolve => setTimeout(resolve, delay));
        }
        
        localStorage.setItem('emailQueue', JSON.stringify(this.queue));
        return { processed: pending.length };
    }

    resendEmail(emailId) {
        const email = this.queue.find(e => e.id === emailId);
        if (email) {
            email.status = 'pending';
            localStorage.setItem('emailQueue', JSON.stringify(this.queue));
            this.processQueue();
        }
    }

    removeFromQueue(emailId) {
        this.queue = this.queue.filter(e => e.id !== emailId);
        localStorage.setItem('emailQueue', JSON.stringify(this.queue));
        this.viewQueue(); // –û–±–Ω–æ–≤–∏—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
    }

    clearQueue() {
        if (confirm('–£–¥–∞–ª–∏—Ç—å –≤—Å–µ –ø–∏—Å—å–º–∞ –∏–∑ –æ—á–µ—Ä–µ–¥–∏?')) {
            this.queue = [];
            localStorage.setItem('emailQueue', JSON.stringify(this.queue));
            document.querySelector('.modal').remove();
            showNotification('–û—á–µ—Ä–µ–¥—å –æ—á–∏—â–µ–Ω–∞', 'success');
        }
    }
}

                        // ===== –ö–õ–ê–°–° ExcelDataLoader –° –û–ë–†–ê–ë–û–¢–ö–û–ô –í–°–ï–• –õ–ò–°–¢–û–í =====
        class ExcelDataLoader {
            constructor() {
                this.setupHandlers();
                this.lastLoadedFile = null;
                this.lastLoadedHash = null;
            }

            setupHandlers() {
                const input = document.getElementById('excel-upload');
                if (input) {
                    input.addEventListener('change', (e) => {
                        const file = e.target.files[0];
                        if (file) {
                            this.loadExcelFile(file);
                        }
                    });
                }
            }

            // –ü–∞—Ä—Å–∏–Ω–≥ –∏–º–µ–Ω–∏ —Å—É–¥–Ω–∞ —Å –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ–º MMSI –∏ IMO
            parseVesselInfo(value) {
                if (!value) return { name: '', mmsi: '', imo: '' };
                
                const str = String(value).trim();
                let name = str;
                let mmsi = '';
                let imo = '';
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –∑–∞–ø–∏—Å–∏
                // –§–æ—Ä–º–∞—Ç: "–ù–∞–∑–≤–∞–Ω–∏–µ —Å—É–¥–Ω–∞ MMSI:123456789" –∏–ª–∏ "–ù–∞–∑–≤–∞–Ω–∏–µ (MMSI 123456789)"
                const mmsiPatterns = [
                    /MMSI[\s:]*(\d{9})/i,
                    /\(MMSI[\s:]*(\d{9})\)/i,
                    /[\s,;](\d{9})(?:\s|$)/,  // 9 —Ü–∏—Ñ—Ä –æ—Ç–¥–µ–ª—å–Ω–æ
                    /MMSI[\s:]*(\d{8,9})/i     // –∏–Ω–æ–≥–¥–∞ 8 —Ü–∏—Ñ—Ä
                ];
                
                for (const pattern of mmsiPatterns) {
                    const match = str.match(pattern);
                    if (match) {
                        mmsi = match[1].padStart(9, '0'); // –î–æ–ø–æ–ª–Ω—è–µ–º –Ω—É–ª—è–º–∏ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
                        name = str.replace(match[0], '').trim();
                        break;
                    }
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º IMO
                const imoPatterns = [
                    /IMO[\s:]*(\d{7})/i,
                    /\(IMO[\s:]*(\d{7})\)/i,
                    /IMO[\s:]*([0-9]{7})/i,
                    /(?:^|\s)(\d{7})(?:\s|$)/  // 7 —Ü–∏—Ñ—Ä –æ—Ç–¥–µ–ª—å–Ω–æ
                ];
                
                for (const pattern of imoPatterns) {
                    const match = str.match(pattern);
                    if (match) {
                        imo = match[1];
                        name = str.replace(match[0], '').trim();
                        break;
                    }
                }
                
                // –û—á–∏—â–∞–µ–º –∏–º—è –æ—Ç –ª–∏—à–Ω–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤
                name = name.replace(/[,;:\-\(\)]+$/, '').trim();
                name = name.replace(/^\[|\]$/g, '').trim();
                
                return { name, mmsi, imo };
            }

            async calculateFileHash(content) {
                let hash = 0;
                for (let i = 0; i < content.length; i++) {
                    const char = content.charCodeAt(i);
                    hash = ((hash << 5) - hash) + char;
                    hash = hash & hash;
                }
                return hash.toString(36);
            }

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–∏–∞–ª–æ–≥ —Å —Ç—Ä–µ–º—è –æ–ø—Ü–∏—è–º–∏
            async showLoadDialog(existingData) {
                return new Promise((resolve) => {
                    const modal = document.createElement('div');
                    modal.className = 'modal';
                    modal.style.cssText = `
                        position: fixed;
                        top: 0;
                        left: 0;
                        right: 0;
                        bottom: 0;
                        background: rgba(0,0,0,0.7);
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        z-index: 10000;
                    `;
                    
                    const dialog = document.createElement('div');
                    dialog.style.cssText = `
                        background: white;
                        border-radius: 8px;
                        padding: 30px;
                        max-width: 500px;
                        box-shadow: 0 4px 20px rgba(0,0,0,0.3);
                    `;
                    
                    dialog.innerHTML = `
                        <h2 style="margin-top: 0; color: #333;">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö Excel</h2>
                        <p style="color: #666; line-height: 1.6;">
                            –í –±–∞–∑–µ —É–∂–µ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ:<br>
                            ‚Ä¢ –¢–µ—Ä–º–∏–Ω–∞–ª–æ–≤: <strong>${existingData.terminals}</strong><br>
                            ‚Ä¢ –°—É–¥–æ–≤: <strong>${existingData.vessels}</strong><br>
                            ‚Ä¢ –ó–∞—è–≤–æ–∫: <strong>${existingData.requests}</strong>
                        </p>
                        <p style="color: #444; margin-top: 20px;">
                            <strong>–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:</strong>
                        </p>
                        <div style="margin-top: 20px; display: flex; gap: 10px; justify-content: space-between;">
                            <button id="btn-replace" style="
                                padding: 10px 20px;
                                background: #dc3545;
                                color: white;
                                border: none;
                                border-radius: 4px;
                                cursor: pointer;
                                font-size: 14px;
                            ">–î–ê - –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å—ë</button>
                            
                            <button id="btn-append" style="
                                padding: 10px 20px;
                                background: #28a745;
                                color: white;
                                border: none;
                                border-radius: 4px;
                                cursor: pointer;
                                font-size: 14px;
                            ">–ù–ï–¢ - –î–æ–±–∞–≤–∏—Ç—å –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º</button>
                            
                            <button id="btn-cancel" style="
                                padding: 10px 20px;
                                background: #6c757d;
                                color: white;
                                border: none;
                                border-radius: 4px;
                                cursor: pointer;
                                font-size: 14px;
                            ">–û—Ç–∫–∞–∑–∞—Ç—å—Å—è</button>
                        </div>
                        <div style="margin-top: 15px; padding: 10px; background: #f8f9fa; border-radius: 4px;">
                            <small style="color: #666;">
                                <strong>–î–ê</strong> - –ü–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö<br>
                                <strong>–ù–ï–¢</strong> - –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –∏ –æ–±–Ω–æ–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ<br>
                                <strong>–û—Ç–∫–∞–∑–∞—Ç—å—Å—è</strong> - –ù–µ –∑–∞–≥—Ä—É–∂–∞—Ç—å —Ñ–∞–π–ª
                            </small>
                        </div>
                    `;
                    
                    modal.appendChild(dialog);
                    document.body.appendChild(modal);
                    
                    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫
                    document.getElementById('btn-replace').onclick = () => {
                        modal.remove();
                        resolve('replace');
                    };
                    
                    document.getElementById('btn-append').onclick = () => {
                        modal.remove();
                        resolve('append');
                    };
                    
                    document.getElementById('btn-cancel').onclick = () => {
                        modal.remove();
                        resolve('cancel');
                    };
                });
            }

            async loadExcelFile(file) {
                showNotification('–ß—Ç–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ Excel...', 'info');

                const reader = new FileReader();
                reader.onload = async (e) => {
                    try {
                        const data = e.target.result;
                        const fileHash = await this.calculateFileHash(data);
                        
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —Ç–æ—Ç –∂–µ –ª–∏ —ç—Ç–æ —Ñ–∞–π–ª
                        if (this.lastLoadedHash === fileHash) {
                            if (!confirm('–≠—Ç–æ—Ç —Ñ–∞–π–ª —É–∂–µ –±—ã–ª –∑–∞–≥—Ä—É–∂–µ–Ω. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?')) {
                                showNotification('–ó–∞–≥—Ä—É–∑–∫–∞ –æ—Ç–º–µ–Ω–µ–Ω–∞', 'warning');
                                return;
                            }
                        }
                        
                        // –ß–∏—Ç–∞–µ–º Excel
                        const workbook = XLSX.read(data, { type: 'binary' });
                        
                        // –°–æ–±–∏—Ä–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ
                        const existingData = {
                            terminals: JSON.parse(localStorage.getItem('ssasTerminals') || '[]').length,
                            vessels: app.vesselDB ? app.vesselDB.vessels.length : 0,
                            requests: JSON.parse(localStorage.getItem('testRequests') || '[]').length
                        };
                        
                        // –ï—Å–ª–∏ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–∏–∞–ª–æ–≥
                        let action = 'replace'; // –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                        if (existingData.terminals > 0 || existingData.vessels > 0 || existingData.requests > 0) {
                            action = await this.showLoadDialog(existingData);
                        }
                        
                        if (action === 'cancel') {
                            showNotification('–ó–∞–≥—Ä—É–∑–∫–∞ –æ—Ç–º–µ–Ω–µ–Ω–∞', 'warning');
                            return;
                        }
                        
                        // –û—á–∏—â–∞–µ–º –¥–∞–Ω–Ω—ã–µ –µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–∞ –∑–∞–º–µ–Ω–∞
                        if (action === 'replace') {
                            this.clearAllData();
                        }
                        
                        // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤—Å–µ –ª–∏—Å—Ç—ã
                        const results = {
                            terminals: { added: 0, updated: 0, skipped: 0 },
                            vessels: { added: 0, updated: 0, skipped: 0 },
                            requests: { added: 0, updated: 0, skipped: 0 }
                        };
                        
                        // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–∞–∂–¥—ã–π –ª–∏—Å—Ç
                        for (const sheetName of workbook.SheetNames) {
                            const worksheet = workbook.Sheets[sheetName];
                            const jsonData = XLSX.utils.sheet_to_json(worksheet);
                            
                            console.log(`–û–±—Ä–∞–±–æ—Ç–∫–∞ –ª–∏—Å—Ç–∞: ${sheetName}, –∑–∞–ø–∏—Å–µ–π: ${jsonData.length}`);
                            
                            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –ª–∏—Å—Ç–∞ –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É
                            const sheetNameLower = sheetName.toLowerCase();
                            
                            if (sheetNameLower.includes('—Ç–µ—Ä–º–∏–Ω–∞–ª') || sheetNameLower.includes('terminal') || 
                                sheetNameLower.includes('—Å—Ç–æ–π–∫') || this.isTerminalData(jsonData)) {
                                // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–∞–∫ —Ç–µ—Ä–º–∏–Ω–∞–ª—ã
                                const result = this.processTerminals(jsonData, action === 'append');
                                results.terminals.added += result.added;
                                results.terminals.updated += result.updated;
                                results.terminals.skipped += result.skipped;
                                
                            } else if (sheetNameLower.includes('—Å—É–¥') || sheetNameLower.includes('vessel') || 
                                      sheetNameLower.includes('ship') || this.isVesselData(jsonData)) {
                                // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–∞–∫ —Å—É–¥–∞
                                const result = this.processVessels(jsonData, action === 'append');
                                results.vessels.added += result.added;
                                results.vessels.updated += result.updated;
                                results.vessels.skipped += result.skipped;
                                
                            } else if (sheetNameLower.includes('–∑–∞—è–≤–∫') || sheetNameLower.includes('request') || 
                                      sheetNameLower.includes('—Ç–µ—Å—Ç') || this.isRequestData(jsonData)) {
                                // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–∞–∫ –∑–∞—è–≤–∫–∏
                                const result = this.processRequests(jsonData, action === 'append');
                                results.requests.added += result.added;
                                results.requests.updated += result.updated;
                                results.requests.skipped += result.skipped;
                                
                            } else {
                                // –ü—ã—Ç–∞–µ–º—Å—è –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É
                                if (this.isTerminalData(jsonData)) {
                                    const result = this.processTerminals(jsonData, action === 'append');
                                    results.terminals.added += result.added;
                                    results.terminals.updated += result.updated;
                                    results.terminals.skipped += result.skipped;
                                }
                            }
                        }
                        
                        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–≥—Ä—É–∑–∫–µ
                        this.lastLoadedFile = file.name;
                        this.lastLoadedHash = fileHash;
                        localStorage.setItem('lastExcelFile', file.name);
                        localStorage.setItem('lastExcelHash', fileHash);
                        localStorage.setItem('lastExcelDate', new Date().toISOString());
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                        loadTerminals();
                        loadRequests();
                        loadDashboardData();
                        
                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
                        let message = '–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞:\n\n';
                        if (results.terminals.added + results.terminals.updated > 0) {
                            message += `–¢–µ—Ä–º–∏–Ω–∞–ª—ã: ${results.terminals.added} –Ω–æ–≤—ã—Ö, ${results.terminals.updated} –æ–±–Ω–æ–≤–ª–µ–Ω–æ\n`;
                        }
                        if (results.vessels.added + results.vessels.updated > 0) {
                            message += `–°—É–¥–∞: ${results.vessels.added} –Ω–æ–≤—ã—Ö, ${results.vessels.updated} –æ–±–Ω–æ–≤–ª–µ–Ω–æ\n`;
                        }
                        if (results.requests.added + results.requests.updated > 0) {
                            message += `–ó–∞—è–≤–∫–∏: ${results.requests.added} –Ω–æ–≤—ã—Ö, ${results.requests.updated} –æ–±–Ω–æ–≤–ª–µ–Ω–æ\n`;
                        }
                        
                        showNotification(message, 'success');

                        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –°–†–ê–ó–£ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
                        setTimeout(() => {
                            loadTerminals();
                            loadRequests();
                            loadSignals();
                            loadDashboardData();
                            
                            // –ï—Å–ª–∏ –º—ã –Ω–∞ –≤–∫–ª–∞–¥–∫–µ, –æ–±–Ω–æ–≤–ª—è–µ–º –µ—ë
                            const activeTab = document.querySelector('.tab.active');
                            if (activeTab) {
                                const tabName = activeTab.textContent;
                                if (tabName.includes('–ó–∞—è–≤–∫–∏')) loadRequests();
                                if (tabName.includes('–°–∏–≥–Ω–∞–ª—ã')) loadSignals();
                                if (tabName.includes('–¢–µ—Ä–º–∏–Ω–∞–ª—ã')) loadTerminals();
                            }
                        }, 100);
                        
                    } catch (error) {
                        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', error);
                        showNotification('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞: ' + error.message, 'error');
                    }
                };
                reader.readAsBinaryString(file);
            }

            // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É
            isTerminalData(data) {
                if (!data || data.length === 0) return false;
                const firstRow = data[0];
                return firstRow.hasOwnProperty('–ù–æ–º–µ—Ä —Å—Ç–æ–π–∫–∏') || 
                       firstRow.hasOwnProperty('terminal_number') ||
                       firstRow.hasOwnProperty('Terminal Number') ||
                       firstRow.hasOwnProperty('Station Number');
            }

            isVesselData(data) {
                if (!data || data.length === 0) return false;
                const firstRow = data[0];
                return (firstRow.hasOwnProperty('–°—É–¥–Ω–æ') || firstRow.hasOwnProperty('Vessel Name')) &&
                       !firstRow.hasOwnProperty('–ù–æ–º–µ—Ä —Å—Ç–æ–π–∫–∏');
            }

            isRequestData(data) {
                if (!data || data.length === 0) return false;
                const firstRow = data[0];
                return firstRow.hasOwnProperty('–î–∞—Ç–∞ —Ç–µ—Å—Ç–∞') || 
                       firstRow.hasOwnProperty('Test Date') ||
                       firstRow.hasOwnProperty('–í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞') ||
                       firstRow.hasOwnProperty('–ö–æ–Ω—Ç–∞–∫—Ç–Ω–æ–µ –ª–∏—Ü–æ');
            }

            // –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
            clearAllData() {
                // –û—á–∏—â–∞–µ–º —Ç–µ—Ä–º–∏–Ω–∞–ª—ã
                localStorage.setItem('ssasTerminals', JSON.stringify([]));
                
                // –û—á–∏—â–∞–µ–º —Å—É–¥–∞
                if (app.vesselDB) {
                    app.vesselDB.vessels = [];
                    app.vesselDB.save();
                }
                
                // –û—á–∏—â–∞–µ–º –∑–∞—è–≤–∫–∏ –∏ —Å–∏–≥–Ω–∞–ª—ã
                localStorage.setItem('testRequests', JSON.stringify([]));
                localStorage.setItem('testSignals', JSON.stringify([]));
                localStorage.setItem('confirmations', JSON.stringify([]));
                
                console.log('–í—Å–µ –¥–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã');
            }

            // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ—Ä–º–∏–Ω–∞–ª–æ–≤
            processTerminals(data, isAppend) {
                const result = { added: 0, updated: 0, skipped: 0 };
                
                const existingTerminals = isAppend ? 
                    JSON.parse(localStorage.getItem('ssasTerminals') || '[]') : [];
                const terminalMap = new Map();
                
                existingTerminals.forEach(t => {
                    terminalMap.set(t.terminal_number, t);
                });
                
                data.forEach(row => {
                    const stationNumber = String(row['–ù–æ–º–µ—Ä —Å—Ç–æ–π–∫–∏'] || row['terminal_number'] || '').trim();
                    const vesselInfo = this.parseVesselInfo(row['–°—É–¥–Ω–æ'] || row['Vessel Name'] || '');
                    
                    if (!stationNumber) {
                        result.skipped++;
                        return;
                    }
                    
                    const existing = terminalMap.get(stationNumber);
                    
                    if (existing && isAppend) {
                        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π
                        existing.current_vessel_name = vesselInfo.name;
                        existing.current_mmsi = vesselInfo.mmsi || row['MMSI'] || '';
                        existing.current_imo = vesselInfo.imo || row['IMO'] || '';
                        existing.owner = row['–í–ª–∞–¥–µ–ª–µ—Ü'] || row['Owner'] || existing.owner;
                        existing.contact_email = row['Email'] || row['Contact Email'] || existing.contact_email;
                        existing.terminal_type = row['–¢–∏–ø —Å–≤—è–∑–∏'] || row['Terminal Type'] || existing.terminal_type;
                        existing.updated_at = new Date().toISOString();
                        result.updated++;
                    } else {
                        // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π
                        const newTerminal = {
                            id: 'T' + Date.now() + Math.random().toString(36).substr(2, 9),
                            terminal_number: stationNumber,
                            terminal_type: row['–¢–∏–ø —Å–≤—è–∑–∏'] || row['Terminal Type'] || 'INMARSAT',
                            current_vessel_name: vesselInfo.name,
                            current_mmsi: vesselInfo.mmsi || row['MMSI'] || '',
                            current_imo: vesselInfo.imo || row['IMO'] || '',
                            owner: row['–í–ª–∞–¥–µ–ª–µ—Ü'] || row['Owner'] || '',
                            contact_email: row['Email'] || row['Contact Email'] || '',
                            is_active: true,
                            created_at: new Date().toISOString(),
                            updated_at: new Date().toISOString()
                        };
                        terminalMap.set(stationNumber, newTerminal);
                        result.added++;
                    }
                });
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º
                const terminals = Array.from(terminalMap.values());
                localStorage.setItem('ssasTerminals', JSON.stringify(terminals));
                
                return result;
            }

            // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å—É–¥–æ–≤
            processVessels(data, isAppend) {
                const result = { added: 0, updated: 0, skipped: 0 };
                
                if (!app.vesselDB) {
                    app.vesselDB = new VesselDB();
                }
                
                if (!isAppend) {
                    app.vesselDB.vessels = [];
                }
                
                data.forEach(row => {
                    const vesselInfo = this.parseVesselInfo(row['–°—É–¥–Ω–æ'] || row['Vessel Name'] || '');
                    
                    if (!vesselInfo.name) {
                        result.skipped++;
                        return;
                    }
                    
                    const vessel = {
                        name: vesselInfo.name,
                        mmsi: vesselInfo.mmsi || row['MMSI'] || '',
                        imo: vesselInfo.imo || row['IMO'] || '',
                        callSign: row['–ü–æ–∑—ã–≤–Ω–æ–π'] || row['Call Sign'] || '',
                        stationNumbers: row['–ù–æ–º–µ—Ä —Å—Ç–æ–π–∫–∏'] ? [String(row['–ù–æ–º–µ—Ä —Å—Ç–æ–π–∫–∏'])] : [],
                        owner: row['–í–ª–∞–¥–µ–ª–µ—Ü'] || row['Owner'] || '',
                        email: row['Email'] || row['Contact Email'] || '',
                        satcomType: row['–¢–∏–ø —Å–≤—è–∑–∏'] || row['Terminal Type'] || 'INMARSAT',
                        flag: row['–§–ª–∞–≥'] || row['Flag'] || '',
                        type: row['–¢–∏–ø —Å—É–¥–Ω–∞'] || row['Vessel Type'] || ''
                    };
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ
                    const existing = app.vesselDB.vessels.find(v => 
                        (vessel.mmsi && v.mmsi === vessel.mmsi) ||
                        (vessel.imo && v.imo === vessel.imo) ||
                        (v.name === vessel.name)
                    );
                    
                    if (existing && isAppend) {
                        // –û–±–Ω–æ–≤–ª—è–µ–º
                        Object.assign(existing, vessel);
                        existing.updated_at = new Date().toISOString();
                        result.updated++;
                    } else if (!existing) {
                        // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–µ
                        app.vesselDB.addVessel(vessel);
                        result.added++;
                    } else {
                        result.skipped++;
                    }
                });
                
                app.vesselDB.save();
                return result;
            }

            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞—è–≤–æ–∫
            processRequests(data, isAppend) {
                const result = { added: 0, updated: 0, skipped: 0 };
                
                const existingRequests = isAppend ? 
                    JSON.parse(localStorage.getItem('testRequests') || '[]') : [];
                
                data.forEach(row => {
                    const vesselInfo = this.parseVesselInfo(row['–°—É–¥–Ω–æ'] || row['Vessel Name'] || '');
                    
                    if (!vesselInfo.name && !row['–ù–æ–º–µ—Ä —Å—Ç–æ–π–∫–∏']) {
                        result.skipped++;
                        return;
                    }
                    
                    const request = {
                        id: 'REQ' + Date.now() + Math.random().toString(36).substr(2, 5),
                        vesselName: vesselInfo.name,
                        mmsi: vesselInfo.mmsi || row['MMSI'] || '',
                        imo: vesselInfo.imo || row['IMO'] || '',
                        stationNumber: String(row['–ù–æ–º–µ—Ä —Å—Ç–æ–π–∫–∏'] || row['Station Number'] || ''),
                        testDate: row['–î–∞—Ç–∞ —Ç–µ—Å—Ç–∞'] || row['Test Date'] || new Date().toISOString().split('T')[0],
                        startTime: row['–í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞'] || row['Start Time'] || '10:00',
                        endTime: row['–í—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è'] || row['End Time'] || '11:00',
                        contactPerson: row['–ö–æ–Ω—Ç–∞–∫—Ç–Ω–æ–µ –ª–∏—Ü–æ'] || row['Contact Person'] || '',
                        contactPhone: row['–¢–µ–ª–µ—Ñ–æ–Ω'] || row['Phone'] || '',
                        email: row['Email'] || '',
                        organization: row['–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è'] || row['Organization'] || '',
                        notes: row['–ü—Ä–∏–º–µ—á–∞–Ω–∏—è'] || row['Notes'] || '',
                        status: row['–°—Ç–∞—Ç—É—Å'] || 'pending',
                        createdAt: new Date().toISOString()
                    };
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
                    const existing = existingRequests.find(r => 
                        r.stationNumber === request.stationNumber &&
                        r.testDate === request.testDate
                    );
                    
                    if (!existing) {
                        existingRequests.push(request);
                        result.added++;
                    } else {
                        result.skipped++;
                    }
                });
                
                localStorage.setItem('testRequests', JSON.stringify(existingRequests));
                return result;
            }

            openFileDialog() {
                const lastFile = localStorage.getItem('lastExcelFile');
                const lastDate = localStorage.getItem('lastExcelDate');
                
                if (lastFile && lastDate) {
                    const date = new Date(lastDate);
                    const dateStr = date.toLocaleDateString('ru-RU') + ' ' + date.toLocaleTimeString('ru-RU');
                    console.log(`–ü–æ—Å–ª–µ–¥–Ω—è—è –∑–∞–≥—Ä—É–∑–∫–∞: ${lastFile} (${dateStr})`);
                }
                
                document.getElementById('excel-upload').click();
            }
        }

        // ===== –§–£–ù–ö–¶–ò–ò –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø =====
        
        function initializeApp() {
            console.log('üöÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥—É–ª—è –¢–ï–°–¢ –°–°–¢–û...');
            
            app.autoConfirmManager = new AutoConfirmationManager();
            app.emailProcessor = new EmailProcessor();
            app.poiskMoreIntegration = new PoiskMoreIntegration();
            app.vesselDB = new VesselDB();
            
            loadDashboardData();
            loadRequests();
            loadSignals();
            loadTerminals();
            
            updateAutoConfirmStatus();
            
            console.log('‚úÖ –ú–æ–¥—É–ª—å —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
        }

        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.querySelectorAll('.tab').forEach(btn => {
                btn.classList.remove('active');
            });
            
            const selectedTab = document.getElementById(tabName);
            if (selectedTab) {
                selectedTab.classList.add('active');
            }
            
            event.target.classList.add('active');
            app.currentTab = tabName;
            
            if (tabName === 'map-container' && !app.map) {
                setTimeout(() => {
                    window.mapManager.initAdvancedMap();
                }, 100);
            }
        }

        function loadDashboardData() {
            const requests = JSON.parse(localStorage.getItem('testRequests') || '[]');
            const signals = JSON.parse(localStorage.getItem('signals') || '[]');
            
            document.getElementById('total-requests').textContent = requests.length;
            document.getElementById('pending-requests').textContent = 
                requests.filter(r => r.status === 'pending').length;
            document.getElementById('confirmed-requests').textContent = 
                requests.filter(r => r.status === 'confirmed').length;
            document.getElementById('total-signals').textContent = signals.length;
        }

        function loadRequests() {
    console.log('üìã –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞—è–≤–æ–∫...');
    
    const requests = JSON.parse(localStorage.getItem('testRequests') || '[]');
    const tbody = document.getElementById('requests-tbody');
    
    if (tbody) {
        tbody.innerHTML = '';
        
        if (requests.length === 0) {
            tbody.innerHTML = '<tr><td colspan="8" style="text-align: center; padding: 20px;">–ù–µ—Ç –∑–∞—è–≤–æ–∫</td></tr>';
        } else {
            requests.forEach(request => {
                const row = document.createElement('tr');
                // –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫: ID, –ù–æ–º–µ—Ä —Å—Ç–æ–π–∫–∏, –°—É–¥–Ω–æ, MMSI, IMO, –î–∞—Ç–∞ —Ç–µ—Å—Ç–∞, –°—Ç–∞—Ç—É—Å, –î–µ–π—Å—Ç–≤–∏—è
                row.innerHTML = `
                    <td>${request.id || 'N/A'}</td>
                    <td>${request.stationNumber || ''}</td>
                    <td>${request.vesselName || ''}</td>
                    <td>${request.mmsi || ''}</td>
                    <td>${request.imo || ''}</td>
                    <td>${request.testDate || ''}</td>
                    <td><span class="status-badge">${request.status === 'pending' ? '–û–∂–∏–¥–∞–µ—Ç' : request.status === 'confirmed' ? '–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ' : '–ù–æ–≤–∞—è'}</span></td>
                    <td><button class="btn btn-primary btn-sm" onclick="viewRequest('${request.id}')">–ü—Ä–æ—Å–º–æ—Ç—Ä</button></td>
                `;
                tbody.appendChild(row);
            });
        }
    }
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞—à–±–æ—Ä–¥ –µ—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
    if (typeof loadDashboard === 'function') {
        loadDashboard();
    } else if (typeof updateDashboardData === 'function') {
        updateDashboardData();
    }
}

if (typeof updateStats === 'undefined') {
    window.updateStats = window.updateDashboardData;
}



// ============= –§–£–ù–ö–¶–ò–ò –î–ê–®–ë–û–†–î–ê –ò –û–ë–ù–û–í–õ–ï–ù–ò–Ø –î–ê–ù–ù–´–• =============

// –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞—à–±–æ—Ä–¥–∞
function loadDashboard() {
    console.log('üìä –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞—à–±–æ—Ä–¥–∞...');
    
    const requests = JSON.parse(localStorage.getItem('testRequests') || '[]');
    const signals = JSON.parse(localStorage.getItem('signals') || '[]');
    const terminals = JSON.parse(localStorage.getItem('ssasTerminals') || localStorage.getItem('terminals') || localStorage.getItem('vessels') || '[]');
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫–∏ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
    const totalRequestsEl = document.getElementById('total-requests');
    const pendingRequestsEl = document.getElementById('pending-requests');
    const confirmedRequestsEl = document.getElementById('confirmed-requests');
    const totalSignalsEl = document.getElementById('total-signals');
    
    if (totalRequestsEl) {
        totalRequestsEl.textContent = requests.length;
    }
    if (pendingRequestsEl) {
        pendingRequestsEl.textContent = requests.filter(r => r.status === 'pending').length;
    }
    if (confirmedRequestsEl) {
        confirmedRequestsEl.textContent = requests.filter(r => r.status === 'confirmed').length;
    }
    if (totalSignalsEl) {
        totalSignalsEl.textContent = signals.length;
    }
    
    console.log(`üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: –ó–∞—è–≤–∫–∏=${requests.length}, –û–∂–∏–¥–∞—é—Ç=${requests.filter(r => r.status === 'pending').length}, –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ=${requests.filter(r => r.status === 'confirmed').length}, –°–∏–≥–Ω–∞–ª—ã=${signals.length}`);
}

// –ê–ª–∏–∞—Å –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å —Ä–∞–∑–Ω—ã–º–∏ –≤–µ—Ä—Å–∏—è–º–∏
function updateDashboardData() {
    console.log('üîÑ updateDashboardData –≤—ã–∑–≤–∞–Ω–∞, –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ loadDashboard');
    loadDashboard();
}

// –ï—â–µ –æ–¥–∏–Ω –∞–ª–∏–∞—Å –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
function updateStats() {
    console.log('üìä updateStats –≤—ã–∑–≤–∞–Ω–∞, –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ loadDashboard');
    loadDashboard();
}

// –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞—è–≤–æ–∫ –≤ —Ç–∞–±–ª–∏—Ü—É
function loadRequests() {
    console.log('üìã –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞—è–≤–æ–∫...');
    
    const requests = JSON.parse(localStorage.getItem('testRequests') || '[]');
    const tbody = document.getElementById('requests-tbody');
    
    if (tbody) {
        tbody.innerHTML = '';
        
        if (requests.length === 0) {
            tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 20px;">–ù–µ—Ç –∑–∞—è–≤–æ–∫</td></tr>';
        } else {
            requests.forEach(request => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${request.id || 'N/A'}</td>
                    <td>${request.stationNumber || ''}</td>
                    <td>${request.vesselName || ''}</td>
                    <td>${request.mmsi || ''}</td>
                    <td>${request.testDate || ''}</td>
                    <td><span class="status-badge">${request.status || 'pending'}</span></td>
                    <td><button class="btn btn-sm" onclick="viewRequest('${request.id}')">–ü—Ä–æ—Å–º–æ—Ç—Ä</button></td>
                `;
                tbody.appendChild(row);
            });
        }
    }
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞—à–±–æ—Ä–¥ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞—è–≤–æ–∫
    loadDashboard();
}

// –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∏–≥–Ω–∞–ª–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü—É
function loadSignals() {
    console.log('üì° –ó–∞–≥—Ä—É–∑–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤...');
    
    const signals = JSON.parse(localStorage.getItem('signals') || '[]');
    const tbody = document.getElementById('signals-tbody');
    
    if (tbody) {
        tbody.innerHTML = '';
        
        if (signals.length === 0) {
            tbody.innerHTML = '<tr><td colspan="8" style="text-align: center; padding: 20px;">–ù–µ—Ç —Å–∏–≥–Ω–∞–ª–æ–≤</td></tr>';
        } else {
            signals.forEach(signal => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${signal.id || 'N/A'}</td>
                    <td>${signal.stationNumber || ''}</td>
                    <td>${signal.vesselName || ''}</td>
                    <td>${signal.mmsi || ''}</td>
                    <td>${signal.receivedAt || signal.positionTime || ''}</td>
                    <td>${signal.signalType || signal.type || ''}</td>
                    <td><span class="status-badge">${signal.status || 'new'}</span></td>
                    <td><button class="btn btn-sm" onclick="viewSignal('${signal.id}')">–ü—Ä–æ—Å–º–æ—Ç—Ä</button></td>
                `;
                tbody.appendChild(row);
            });
        }
    }
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞—à–±–æ—Ä–¥ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∏–≥–Ω–∞–ª–æ–≤
    loadDashboard();
}

// –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–µ—Ä–º–∏–Ω–∞–ª–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü—É
function loadTerminals() {
    console.log('üö¢ –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ—Ä–º–∏–Ω–∞–ª–æ–≤...');
    
    const terminals = JSON.parse(localStorage.getItem('ssasTerminals') || localStorage.getItem('terminals') || localStorage.getItem('vessels') || '[]');
    const tbody = document.getElementById('terminals-tbody');
    
    if (tbody) {
        tbody.innerHTML = '';
        
        if (terminals.length === 0) {
            tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 20px;">–ù–µ—Ç —Ç–µ—Ä–º–∏–Ω–∞–ª–æ–≤</td></tr>';
        } else {
            terminals.forEach(terminal => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${terminal.terminal_number || terminal.stationNumber || ''}</td>
                    <td>${terminal.vessel_name || terminal.vesselName || terminal.name || ''}</td>
                    <td>${terminal.mmsi || ''}</td>
                    <td>${terminal.terminal_type || terminal.terminalType || terminal.type || 'INMARSAT'}</td>
                    <td>${terminal.owner || ''}</td>
                    <td><span class="status-badge">${terminal.status || 'active'}</span></td>
                    <td><button class="btn btn-sm" onclick="viewTerminal('${terminal.id}')">–ü—Ä–æ—Å–º–æ—Ç—Ä</button></td>
                `;
                tbody.appendChild(row);
            });
        }
    }
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞—à–±–æ—Ä–¥ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–µ—Ä–º–∏–Ω–∞–ª–æ–≤
    loadDashboard();
}

// –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
function viewRequest(id) {
    console.log('–ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞—è–≤–∫–∏:', id);
    // –ó–¥–µ—Å—å –º–æ–∂–µ—Ç –±—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏–ª–∏ –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –¥–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
}

function viewSignal(id) {
    console.log('–ü—Ä–æ—Å–º–æ—Ç—Ä —Å–∏–≥–Ω–∞–ª–∞:', id);
    // –ó–¥–µ—Å—å –º–æ–∂–µ—Ç –±—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏–ª–∏ –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –¥–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
}

function viewTerminal(id) {
    console.log('–ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–µ—Ä–º–∏–Ω–∞–ª–∞:', id);
    // –ó–¥–µ—Å—å –º–æ–∂–µ—Ç –±—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏–ª–∏ –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –¥–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
}

// ============= –ö–û–ù–ï–¶ –§–£–ù–ö–¶–ò–ô –î–ê–®–ë–û–†–î–ê =============

</script>
</body>
</html>