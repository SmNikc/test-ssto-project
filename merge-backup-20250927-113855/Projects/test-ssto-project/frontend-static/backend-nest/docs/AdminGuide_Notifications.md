# Руководство администратора модуля «Тест ССТО»: Настройка уведомлений

## Введение
Этот раздел описывает настройку системы уведомлений в модуле «Тест ССТО». Уведомления отправляются по email, SMS и Telegram для информирования о событиях (например, тревожные сигналы, ошибки).

## Доступ к настройкам
1. Войдите в панель администратора:
    - Авторизуйтесь в Keycloak с ролью `admin` (см. [Введение](#введение)).
    - Перейдите в «Панель администратора» → «Управление уведомлениями».

## Настройка каналов уведомлений
1. Email (SMTP):
    - Убедитесь, что параметры SMTP настроены в .env:
        SMTP_HOST=smtp.morflot.ru
        SMTP_PORT=587
        SMTP_USER=od_smrcc@morflot.ru
        SMTP_PASS=your_smtp_password
    - Проверьте отправку тестового email:
        echo "Test email" | mail -s "Test" operator@gmskcc.ru

2. SMS (Twilio):
    - Настройте параметры Twilio в .env:
        TWILIO_SID=your_twilio_sid
        TWILIO_TOKEN=your_twilio_token
        TWILIO_PHONE=your_twilio_phone
    - Проверьте отправку тестового SMS через API (например, curl).

3. Telegram:
    - Настройте Telegram API в .env:
        TELEGRAM_BOT_TOKEN=your_telegram_token
    - Проверьте отправку тестового сообщения через API.

## Создание правил уведомлений
1. Выберите событие:
    - В разделе «Управление уведомлениями» выберите событие:
        - Получение тревожного сигнала.
        - Ошибка обработки сигнала.
        - Ежедневная сводка.

2. Укажите каналы и получателей:
    - Email: operator@gmskcc.ru
    - SMS: +7 (495) 123-45-67
    - Telegram ID: 123456789

3. Настройте текст:
    - Пример: `Тревожный сигнал MMSI {MMSI} получен в {TIME}`.
    - Максимум 300 символов.
    - Нажмите «Сохранить».

## Проверка уведомлений
1. Отправьте тестовое уведомление:
    - Выберите канал (например, Email).
    - Нажмите «Отправить тестовое уведомление».
    - Проверьте получение (например, в почтовом ящике).

2. Просмотрите логи:
    - Перейдите в «Логи» → «Уведомления».
    - Проверьте статус: «Успешно» или «Ошибка».

## Устранение неполадок
- Уведомление не отправляется:
    - Проверьте параметры в .env.
    - Проверьте логи backend: docker logs backend.
    - Убедитесь, что сервисы (SMTP, Twilio, Telegram) доступны.

- Сообщение не доставлено:
    - Для email: Проверьте папку «Спам».
    - Для SMS/Telegram: Проверьте API ключи и лимиты.

**Совет**: Настройте уведомления для тревожных сигналов как приоритетные.
